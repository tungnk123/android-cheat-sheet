
---
1. **Serialization / Intent Bugs**
	- **Empty JSON with Kotlin Serialization** → missing `@Serializable`.
	- **Fix:** add `@Serializable` to all nested classes; use `Json.encodeToString`.
	
	- **Parcelable crash in Service** → class stripped / CREATOR missing.
	- **Fix:** Proguard keep rules or stop passing complex objects via Intent.
	
	- **Serializable cast NPE** → missing/invalid extra.
	- **Fix:** null-safe read or pass IDs and reload from DB.
2. **Problem: Activity Recreates Multiple Times**

**Root Cause:** Orientation change when switching between portrait/landscape activities + locale context wrapping

**Flow:**

```
MainActivity (portrait) → DashboardActivity (landscape) → back to MainActivity
→ Orientation changes → MainActivity recreates → Multiple dialogs/permission requests
```

**Why It Happens**

1. **Orientation Change:** portrait ↔ landscape triggers configuration change
2. **Locale Wrapping:** `attachBaseContext()` + `createConfigurationContext()` adds locale to config
3. **No configChanges:** MainActivity doesn't handle config changes → Android recreates it
**Why It Didn't Happen Before**

**Before locale feature:**
- Only orientation change
- Android reused MainActivity instance
**After locale feature:**
- Orientation + locale context wrap
- Multiple configuration changes → forced recreate
**Solution: Add configChanges**
xml
```
<activity
    android:name=".ui.main.MainActivity"
    android:screenOrientation="portrait"
    android:configChanges="orientation|screenSize|layoutDirection|screenLayout|keyboardHidden" />
```

**DO NOT add** `**locale**` - it breaks language switching

**Problem:** `attachBaseContext()` locale wrapping + orientation change = multiple recreates

**Solution:** `configChanges` without `locale` + AppCompatDelegate